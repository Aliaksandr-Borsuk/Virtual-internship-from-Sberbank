# Оценка стабильной части средств на расчётных счетах  
**Виртуальная стажировка Сбербанка — ML-задача по прогнозированию ликвидности**
> Цель: построить модель, которая оценивает **минимальный устойчивый объём средств** на расчётных счетах физических лиц (UMP - Undefined Maturity Product) на заданный горизонт (от 1 до 12 месяцев).

---

##  Постановка задачи
Клиенты могут снимать деньги с расчётного счёта в любой момент, но исторически наблюдается **«стабильная часть»** - уровень, ниже которого совокупный баланс практически не опускается.  
Банку важно:
- **Не занижать** прогноз → избежать *пробития* (фактический баланс < прогноз)
- **Не завышать** прогноз → избежать *неэффективного замораживания капитала*

Это классическая задача **асимметричной ошибки**, идеально решаемая через **квантильную регрессию**.

---

## Подход
- Использована модель **`QuantileRegressor`** из `sklearn`
- Прогноз строится на **минимальном значении баланса** за каждый горизонт (1M, 2M, ..., 12M)
- Модель обучается на **фиктивной временной переменной** (`t = 0, 1, 2, ...`)
- Квантиль регулирует баланс между риском пробития и избытком:
  - **Низкий квантиль (например, 0.05)** → консервативный прогноз → меньше пробитий
  - **Высокий квантиль** → точнее отражает средний уровень, но выше риск пробития

---

## Данные
- Источник: подневные данные по балансам расчётных счетов (2013–2019)
- Объём: ~2100 записей
- Предобработка:
  - Удалены данные до **2015 г.** (период резкой девальвации рубля)
  - Проверены дубликаты и пропуски - отсутствуют
  - Ряд нестационарен (явный восходящий тренд)

 Экзогенные факторы (курс, инфляция, события) не учитываются - задача решена в рамках учебного задания.

---

##  Оценка качества
- Тестирование на нескольких точках во времени (`2017–2019`)
- Горизонты: `1M`, `2M`, `3M`, `6M`
- Метрики:
  - **Абсолютная ошибка**: `|факт – прогноз|`
  - **Квантильный loss**: `max(τ·e, (τ−1)·e)`
- Вывод: выбор квантиля позволяет гибко управлять приоритетами бизнеса

---

## Как запустить
1. Клонировать репозиторий
2. Установить зависимости:
   ```bash
   pip install pandas numpy scikit-learn matplotlib jupyter
      
3. Открыть ноутбук virtual_stajirovka_sber_1.ipynb в Jupyter / Colab
4. Выполнить ячейки последовательно

## Лицензия
MIT
